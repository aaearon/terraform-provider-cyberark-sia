---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "cyberarksia_database_policy Resource - terraform-provider-cyberarksia"
subcategory: ""
description: |-
  Manages a CyberArk SIA database access policy including metadata and access conditions. This resource manages policy-level configuration only. Use cyberarksia_database_policy_principal_assignment to assign principals (users/groups/roles) and cyberarksia_database_policy_assignment to assign database workspaces.
  Pattern: Follows the modular assignment pattern for distributed team workflows - security teams manage policies and principals, application teams manage database assignments independently.
---

# cyberarksia_database_policy (Resource)

Manages a CyberArk SIA database access policy including metadata and access conditions. This resource manages policy-level configuration only. Use `cyberarksia_database_policy_principal_assignment` to assign principals (users/groups/roles) and `cyberarksia_database_policy_assignment` to assign database workspaces.

**Pattern**: Follows the modular assignment pattern for distributed team workflows - security teams manage policies and principals, application teams manage database assignments independently.



<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `name` (String) Policy name (1-200 characters, unique per tenant). **ForceNew**: Changing this creates a new policy.
- `status` (String) Policy status. Valid values: `active` (enabled), `suspended` (disabled). **Note**: `expired`, `validating`, and `error` are server-managed statuses and cannot be set by users.

### Optional

- `conditions` (Block, Optional) Policy access conditions (session limits, idle timeouts, time windows). (see [below for nested schema](#nestedblock--conditions))
- `delegation_classification` (String) Delegation classification. Valid values: `restricted`, `unrestricted`. Default: `unrestricted`. **Note**: Currently, SIA only supports `unrestricted` for database policies regardless of the value set. This attribute is available for future compatibility.
- `description` (String) Policy description (max 200 characters).
- `last_modified` (String) Timestamp of the last modification to the policy.
- `policy_tags` (List of String) List of tags for policy organization (max 20 tags).
- `principal` (Block List) Principal assignment (repeatable block). **Required**: At least 1 principal block is required. Follows familiar Terraform patterns (aws_security_group ingress/egress). Use `lifecycle { ignore_changes = [principal] }` if managing assignments via separate `cyberarksia_database_policy_principal_assignment` resources. (see [below for nested schema](#nestedblock--principal))
- `target_database` (Block List) Database workspace assignment (repeatable block). **Required**: At least 1 target_database block is required. Follows familiar Terraform patterns (aws_security_group ingress/egress). Use `lifecycle { ignore_changes = [target_database] }` if managing assignments via separate `cyberarksia_policy_database_assignment` resources. (see [below for nested schema](#nestedblock--target_database))
- `time_frame` (Block, Optional) Policy validity period. **Optional**: If not specified, policy never expires (valid indefinitely). When specified, both `from_time` and `to_time` must be provided. (see [below for nested schema](#nestedblock--time_frame))
- `time_zone` (String) Timezone for access window conditions (max 50 characters). Supports IANA timezone names (e.g., `America/New_York`) or GMT offsets (e.g., `GMT+05:00`). Default: `GMT`.

### Read-Only

- `created_by` (Attributes) Metadata about policy creation (set by API). (see [below for nested schema](#nestedatt--created_by))
- `id` (String) Policy identifier (same as policy_id).
- `policy_id` (String) Unique policy identifier (UUID, API-generated).
- `updated_on` (Attributes) Metadata about the last policy update (set by API). (see [below for nested schema](#nestedatt--updated_on))

<a id="nestedblock--conditions"></a>
### Nested Schema for `conditions`

Required:

- `max_session_duration` (Number) Maximum session duration in hours (1-24). **Required**.

Optional:

- `access_window` (Block, Optional) Time-based access restrictions (days and hours). (see [below for nested schema](#nestedblock--conditions--access_window))
- `idle_time` (Number) Session idle timeout in minutes (1-120). Default: 10.

<a id="nestedblock--conditions--access_window"></a>
### Nested Schema for `conditions.access_window`

Required:

- `days_of_the_week` (Set of Number) Days access is allowed (0=Sunday through 6=Saturday). Specify days in any order - order is automatically normalized. Example: `[1, 2, 3, 4, 5]` for weekdays.

Optional:

- `from_hour` (String) Start time in HH:MM format (e.g., `09:00`). Optional - if both `from_hour` and `to_hour` are omitted, access is allowed all day. If one is specified, the other must also be specified.
- `to_hour` (String) End time in HH:MM format (e.g., `17:00`). Optional - if both `from_hour` and `to_hour` are omitted, access is allowed all day. If one is specified, the other must also be specified.



<a id="nestedblock--principal"></a>
### Nested Schema for `principal`

Required:

- `principal_id` (String) Principal identifier in UUID format (e.g., `c2c7bcc6-9560-44e0-8dff-5be221cd37ee`). This is the unique identifier returned by the SIA API.
- `principal_name` (String) Principal name (SystemName). For USER: email format (e.g., `user@example.com`). For GROUP/ROLE: display name (e.g., `CyberIAM Guardians`, `Database Administrators`).
- `principal_type` (String) Principal type. Valid values: `USER`, `GROUP`, `ROLE`.

Optional:

- `source_directory_id` (String) Source identity directory ID. **Required** for USER and GROUP types.
- `source_directory_name` (String) Source identity directory name (max 50 characters). **Required** for USER and GROUP types.


<a id="nestedblock--target_database"></a>
### Nested Schema for `target_database`

Required:

- `authentication_method` (String) Authentication method. Valid values: `db_auth`, `ldap_auth`, `oracle_auth`, `mongo_auth`, `sqlserver_auth`, `rds_iam_user_auth`.
- `database_workspace_id` (String) The ID of the database workspace to assign.

Optional:

- `db_auth_profile` (Block, Optional) Database authentication profile. **Required** when `authentication_method` is `db_auth`. (see [below for nested schema](#nestedblock--target_database--db_auth_profile))
- `ldap_auth_profile` (Block, Optional) LDAP authentication profile. **Required** when `authentication_method` is `ldap_auth`. (see [below for nested schema](#nestedblock--target_database--ldap_auth_profile))
- `mongo_auth_profile` (Block, Optional) MongoDB authentication profile. **Required** when `authentication_method` is `mongo_auth`. (see [below for nested schema](#nestedblock--target_database--mongo_auth_profile))
- `oracle_auth_profile` (Block, Optional) Oracle authentication profile. **Required** when `authentication_method` is `oracle_auth`. (see [below for nested schema](#nestedblock--target_database--oracle_auth_profile))
- `rds_iam_user_auth_profile` (Block, Optional) RDS IAM User authentication profile. **Required** when `authentication_method` is `rds_iam_user_auth`. (see [below for nested schema](#nestedblock--target_database--rds_iam_user_auth_profile))
- `sqlserver_auth_profile` (Block, Optional) SQL Server authentication profile. **Required** when `authentication_method` is `sqlserver_auth`. (see [below for nested schema](#nestedblock--target_database--sqlserver_auth_profile))

<a id="nestedblock--target_database--db_auth_profile"></a>
### Nested Schema for `target_database.db_auth_profile`

Optional:

- `roles` (List of String) List of database roles to assign.


<a id="nestedblock--target_database--ldap_auth_profile"></a>
### Nested Schema for `target_database.ldap_auth_profile`

Optional:

- `assign_groups` (List of String) List of LDAP groups to assign.


<a id="nestedblock--target_database--mongo_auth_profile"></a>
### Nested Schema for `target_database.mongo_auth_profile`

Optional:

- `database_builtin_roles` (Map of List of String) Map of database names to built-in roles.
- `database_custom_roles` (Map of List of String) Map of database names to custom roles.
- `global_builtin_roles` (List of String) List of global built-in roles.


<a id="nestedblock--target_database--oracle_auth_profile"></a>
### Nested Schema for `target_database.oracle_auth_profile`

Optional:

- `dba_role` (Boolean) Grant DBA role.
- `roles` (List of String) List of Oracle roles to assign.
- `sysdba_role` (Boolean) Grant SYSDBA role.
- `sysoper_role` (Boolean) Grant SYSOPER role.


<a id="nestedblock--target_database--rds_iam_user_auth_profile"></a>
### Nested Schema for `target_database.rds_iam_user_auth_profile`

Optional:

- `db_user` (String) Database user for RDS IAM authentication.


<a id="nestedblock--target_database--sqlserver_auth_profile"></a>
### Nested Schema for `target_database.sqlserver_auth_profile`

Optional:

- `database_builtin_roles` (Map of List of String) Map of database names to built-in roles.
- `database_custom_roles` (Map of List of String) Map of database names to custom roles.
- `global_builtin_roles` (List of String) List of global built-in roles.
- `global_custom_roles` (List of String) List of global custom roles.



<a id="nestedblock--time_frame"></a>
### Nested Schema for `time_frame`

Optional:

- `from_time` (String) Start time (ISO 8601 format, e.g., `2024-01-01T00:00:00Z`). Required when `time_frame` block is present.
- `to_time` (String) End time (ISO 8601 format, e.g., `2024-12-31T23:59:59Z`). Required when `time_frame` block is present.


<a id="nestedatt--created_by"></a>
### Nested Schema for `created_by`

Read-Only:

- `timestamp` (String) Creation timestamp in ISO 8601 format.
- `user` (String) Username of the user who created the policy.


<a id="nestedatt--updated_on"></a>
### Nested Schema for `updated_on`

Read-Only:

- `timestamp` (String) Last update timestamp in ISO 8601 format.
- `user` (String) Username of the user who last updated the policy.
